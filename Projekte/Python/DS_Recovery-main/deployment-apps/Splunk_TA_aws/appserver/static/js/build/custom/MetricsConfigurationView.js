import{_ as e,d as t,i as a,a as s,h as n}from"./_rollupPluginBabelHelpers-deef47fd.js";import{$ as i,n as l,q as c,s as r,w as d,t as o,v as m,c as u,R as h,b as p,T as f,h as v,x as _,y as g,z as M,A as y,E as k,i as b,l as N,f as S,G as C,H as w}from"./vendor-e1fcc605.js";import{T as x}from"./Theme-fcd59ca3.js";var D="/home/runner/work/splunk-add-on-for-amazon-web-services/splunk-add-on-for-amazon-web-services/build-ui/js/dependencies/DimensionMetricsPanel.js",O=function(){function n(e){s(this,n),this.defaultDimensions=e.defaultDimensions,this.defaultMetrics=e.defaultMetrics,this.defaultStatistics=e.defaultStatistics,this.model=e.model,this.selectedModel=e.selectedModel,this.el=i("#dimension-list-section")}return e(n,[{key:"_handleDimensionsChange",value:function(e,t,a){var s=t.value,n=this._parseDimension(s);if(n){i(e.target).parent().removeClass("json-err-state"),i(e.target).parent().removeAttr("data-namespace"),i(e.target).removeClass("json-err-state"),this.selectedModel.metric_dimensions_list[a]=n;var l=this.selectedModel.metric_namespace;i('.namespace-cell[data-namespace="'.concat(l,'"]')).addClass("namespace-edited-marker"),this.selectedModel.change_set.includes("metric_dimensions_list")||this.selectedModel.change_set.push("metric_dimensions_list")}else i(e.target).parent().addClass("json-err-state"),i(e.target).parent().attr("data-namespace",this.selectedModel.metric_namespace),i(e.target).addClass("json-err-state")}},{key:"_handleMetricsChange",value:function(e,t,a){var s=t.values;this.selectedModel.metric_names_list[a]=this._handleAllOption(s);var n=this.selectedModel.metric_namespace;i('.namespace-cell[data-namespace="'.concat(n,'"]')).addClass("namespace-edited-marker"),this.selectedModel.change_set.includes("metric_names_list")||this.selectedModel.change_set.push("metric_names_list"),i('[data-test="layer-container"] [data-test="layer"]>div').remove(),this.render()}},{key:"_handleStatisticsChange",value:function(e,t,a){var s=t.values;this.selectedModel.statistics_list[a]=s;var n=this.selectedModel.metric_namespace;i('.namespace-cell[data-namespace="'.concat(n,'"]')).addClass("namespace-edited-marker")}},{key:"_addMetrics",value:function(){this.selectedModel.metric_dimensions_list.push([]),this.selectedModel.metric_names_list.push([]),this.selectedModel.statistics_list.push([]);var e=this.selectedModel.metric_namespace;i('.namespace-cell[data-namespace="'.concat(e,'"]')).addClass("namespace-edited-marker"),this._updateChangeSet(),this.render()}},{key:"_removeMetrics",value:function(e){var t=parseInt(i(e.target).data("index"));this.selectedModel.metric_dimensions_list.splice(t,1),this.selectedModel.metric_names_list.splice(t,1),this.selectedModel.statistics_list.splice(t,1);var a=this.selectedModel.metric_namespace;i('.namespace-cell[data-namespace="'.concat(a,'"]')).addClass("namespace-edited-marker"),this._updateChangeSet(),this.render()}},{key:"_resetMetrics",value:function(){var e=this,t=this.selectedModel.metric_namespace,a=l(this.defaultDimensions[t]),s=[],n=[];if(a){a.forEach((function(){s.push([".*"]),n.push(e.defaultStatistics)})),this.selectedModel.metric_dimensions_list=JSON.parse(JSON.stringify(a)),this.selectedModel.metric_names_list=JSON.parse(JSON.stringify(s)),this.selectedModel.statistics_list=JSON.parse(JSON.stringify(n)),this.selectedModel.change_set=[];var c=this.selectedModel.metric_namespace;i('.namespace-cell[data-namespace="'.concat(c,'"]')).removeClass("namespace-edited-marker"),this.render()}}},{key:"_updateChangeSet",value:function(){this.selectedModel.change_set.includes("metric_names_list")||this.selectedModel.change_set.push("metric_names_list"),this.selectedModel.change_set.includes("metric_dimensions_list")||this.selectedModel.change_set.push("metric_dimensions_list")}},{key:"_parseDimension",value:function(e){try{for(var t=JSON.parse(e),a=1;a<t.length;a++){var s=c(t[a-1]),n=c(t[a]);if(r(s,n).length>0)return!1}return t}catch(e){}return!1}},{key:"_handleAllOption",value:function(e,t){return e.length>0&&-1!==e.indexOf(".*")&&(e=".*"===e[e.length-1]?[".*"]:d(e,".*")),e}},{key:"render",value:function(){var e=this;if(this.selectedModel.metric_namespace){for(var s=this.selectedModel.metric_dimensions_list,n=this.selectedModel.metric_names_list,l=this.selectedModel.statistics_list,r=this.selectedModel.metric_namespace,d=[],g=function(e){var t=[];m(s[e],(function(e){t=_(t,c(e))})),d.push({dimensionTitle:t.join(", "),dimensionValue:JSON.stringify(s[e])})},M=0;M<s.length;M++)g(M);this.el.html(o('\x3c!--htmlhint spec-char-escape:false --\x3e\n<!DOCTYPE html>\n\x3c!--\n-- SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>\n-- SPDX-License-Identifier: LicenseRef-Splunk-8-2021\n--\n--\x3e\n\n<% for (var i = 0; i < dimensionList.length; i++) { %> <% var dimensionItem = dimensionList[i]; %>\n<div class="metrics-row">\n    <div class="metrics-cell metrics-title"><%-dimensionItem.dimensionTitle%></div>\n    <div class="metrics-cell"><span class="dimensions-value" data-index="<%-i%>"></span></div>\n    <div class="metrics-cell"><span class="metrics-value" data-index="<%-i%>"></span></div>\n    <div class="metrics-cell"><span class="statistics-value" data-index="<%-i%>"></span></div>\n    <svg\n        data-index="<%-i%>"\n        class="metrics-remove-button"\n        viewBox="0 0 16 16"\n        width="16"\n        height="16"\n        style="vertical-align: middle"\n    >\n        <path\n            data-index="<%-i%>"\n            d="M12.2024 2.69009C12.5092 2.38325 13.0067 2.38325 13.3136 2.69009C13.6204 2.99693 13.6204 3.49442 13.3136 3.80126L9.11721 7.99762L13.3114 12.1918C13.6206 12.501 13.6206 13.0023 13.3114 13.3114C13.0023 13.6206 12.501 13.6206 12.1918 13.3114L7.99762 9.11721L3.885 13.2298C3.57816 13.5367 3.08067 13.5367 2.77383 13.2298C2.46699 12.923 2.46699 12.4255 2.77383 12.1187L6.88645 8.00604L2.69183 3.81142C2.38267 3.50226 2.38267 3.001 2.69183 2.69183C3.001 2.38267 3.50226 2.38267 3.81142 2.69183L8.00604 6.88646L12.2024 2.69009Z"\n            fill="currentColor"\n            style="vertical-align: middle"\n        ></path>\n    </svg>\n</div>\n<% } %>\n<a id="metrics-add-button">\n    <svg\n        focusable="false"\n        height="9px"\n        width="9px"\n        viewBox="0 0 1500 1500"\n        aria-hidden="false"\n        preserveAspectRatio="xMidYMid"\n        xmlns="http://www.w3.org/2000/svg"\n        style="fill: currentColor"\n    >\n        <path\n            d="M843.943 655.03L1500 656.058V844.97H843.943V1500H655.03V844.97L0 843.942V655.03h655.03V0h188.913"\n        ></path>\n    </svg>\n    Add Another\n</a>\n<a id="metrics-reset-button">\n    <svg\n        focusable="false"\n        height="9px"\n        width="9px"\n        viewBox="0 0 1500 1277"\n        aria-hidden="false"\n        preserveAspectRatio="xMidYMid"\n        xmlns="http://www.w3.org/2000/svg"\n        style="fill: currentColor"\n    >\n        <path\n            d="M185.585 185.585C244.608 126.56 313.28 80.875 391.6 48.525 469.92 16.174 552.213 0 638.48 0c86.265 0 168.557 16.175 246.878 48.524 78.32 32.35 146.992 78.037 206.015 137.06 90.24 94.212 148.128 204.314 173.667 330.307H1500l-306.47 371.17-322.645-373.723h234.96c-20.43-80.59-61.86-153.235-124.29-217.934-51.078-50.51-102.44-86.69-154.086-108.54-51.647-21.852-114.644-32.777-188.99-32.777-73.78 0-136.494 10.925-188.14 32.776-51.645 21.85-102.724 58.03-153.234 108.54-50.51 51.08-86.55 102.44-108.116 154.087-21.567 51.645-32.35 114.642-32.35 188.99 0 74.346 10.64 137.2 31.924 188.563 21.283 51.362 57.463 102.582 108.542 153.66 50.51 50.512 101.447 86.55 152.81 108.117 51.36 21.566 114.216 32.35 188.563 32.35 74.346 0 137.485-10.784 189.414-32.35 51.93-21.567 103.15-57.605 153.66-108.116l109.82 110.67c-59.024 59.023-127.696 104.71-206.016 137.06-78.32 32.35-160.613 48.524-246.88 48.524-86.265 0-168.557-16.175-246.878-48.524-78.32-32.35-146.992-78.037-206.015-137.06-59.024-59.024-104.71-127.696-137.06-206.016C16.174 807.038 0 724.745 0 638.478 0 552.214 16.175 469.922 48.524 391.6c32.35-78.32 78.037-146.992 137.06-206.015z"\n        ></path>\n    </svg>\n    Reset To Default\n</a>\n')({dimensionList:d})),m(i(".dimensions-value"),(function(a,s){u.render(h.createElement(p.SplunkThemeProvider,t({},x,{__self:e,__source:{fileName:D,lineNumber:166,columnNumber:11}}),h.createElement(f,{multiline:!0,defaultValue:d[s].dimensionValue,onChange:function(t,a){var n=a.value;return e._handleDimensionsChange(t,{value:n},s)},__self:e,__source:{fileName:D,lineNumber:167,columnNumber:13}})),a)})),m(i(".metrics-value"),(function(a,s){var i=e.defaultMetrics[r];i||(i=[]);var l=i.map((function(t){return h.createElement(v.Option,{key:t,label:t,value:t,__self:e,__source:{fileName:D,lineNumber:181,columnNumber:51}})}));l.push(h.createElement(v.Option,{label:"All",value:".*",__self:e,__source:{fileName:D,lineNumber:182,columnNumber:26}})),u.render(h.createElement(p.SplunkThemeProvider,t({},x,{__self:e,__source:{fileName:D,lineNumber:184,columnNumber:11}}),h.createElement(v,{allowNewValues:!0,tabConfirmsNewValue:!0,defaultValues:n[s],onChange:function(t,a){var n=a.values;return e._handleMetricsChange(t,{values:n},s)},__self:e,__source:{fileName:D,lineNumber:185,columnNumber:13}},l)),a)})),m(i(".statistics-value"),(function(a,s){var n=e.defaultStatistics;u.render(h.createElement(p.SplunkThemeProvider,t({},x,{__self:e,__source:{fileName:D,lineNumber:201,columnNumber:11}}),h.createElement(v,{allowNewValues:!0,tabConfirmsNewValue:!0,defaultValues:l[s],onChange:function(t,a){var n=a.values;return e._handleStatisticsChange(t,{values:n},s)},__self:e,__source:{fileName:D,lineNumber:202,columnNumber:13}},n.map((function(t){return h.createElement(v.Option,{key:t,label:t,value:t,__self:e,__source:{fileName:D,lineNumber:209,columnNumber:17}})})))),a)}));var y,k=a(i(".metrics-remove-button"));try{for(k.s();!(y=k.n()).done;){var b=y.value;i(b).on("click",(function(t){e._removeMetrics(t)}))}}catch(e){k.e(e)}finally{k.f()}i("#metrics-reset-button").on("click",(function(){e._resetMetrics()})),i("#metrics-add-button").on("click",(function(){e._addMetrics()}))}else this.el.empty()}}]),n}(),L="/home/runner/work/splunk-add-on-for-amazon-web-services/splunk-add-on-for-amazon-web-services/build-ui/js/dependencies/NamespaceListPanel.js",J=function(){function n(e){s(this,n),this.el=i("#namespace-list-section"),this.model=e.model,this.selectedModel=e.selectedModel,this.defaultNamespaces=e.defaultNamespaces,this.defaultDimensions=e.defaultDimensions,this.defaultMetrics=e.defaultMetrics,this.defaultStatistics=e.defaultStatistics,this.editMarks=[]}return e(n,[{key:"render",value:function(){var e=this,s=g(this.model,(function(e){return e.metric_namespace}));this.el.html(o('\x3c!--htmlhint spec-char-escape:false --\x3e\n<!DOCTYPE html>\n\x3c!--\n-- SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>\n-- SPDX-License-Identifier: LicenseRef-Splunk-8-2021\n--\n--\x3e\n\n<% for (var i = 0; i < namespaces.length; i++) { %>\n<div class="namespace-cell" data-namespace="<%-namespaces[i]%>">\n    <%-namespaces[i]%>\n    <a data-namespace="<%-namespaces[i]%>" class="namespace-remove-button">\n        <svg\n            data-namespace="<%-namespaces[i]%>"\n            viewBox="0 0 16 16"\n            width="16"\n            height="16"\n            style="vertical-align: middle"\n        >\n            <path\n                data-namespace="<%-namespaces[i]%>"\n                d="M12.2024 2.69009C12.5092 2.38325 13.0067 2.38325 13.3136 2.69009C13.6204 2.99693 13.6204 3.49442 13.3136 3.80126L9.11721 7.99762L13.3114 12.1918C13.6206 12.501 13.6206 13.0023 13.3114 13.3114C13.0023 13.6206 12.501 13.6206 12.1918 13.3114L7.99762 9.11721L3.885 13.2298C3.57816 13.5367 3.08067 13.5367 2.77383 13.2298C2.46699 12.923 2.46699 12.4255 2.77383 12.1187L6.88645 8.00604L2.69183 3.81142C2.38267 3.50226 2.38267 3.001 2.69183 2.69183C3.001 2.38267 3.50226 2.38267 3.81142 2.69183L8.00604 6.88646L12.2024 2.69009Z"\n                fill="currentColor"\n            ></path>\n        </svg>\n    </a>\n</div>\n<% } %>\n<div class="namespace-cell" id="namespace-add-cell">\n    <span id="namespace-value"></span>\n    <a id="namespace-add-cancel-button">\n        <svg viewBox="0 0 16 16" width="16" height="16" style="vertical-align: middle">\n            <path\n                d="M12.2024 2.69009C12.5092 2.38325 13.0067 2.38325 13.3136 2.69009C13.6204 2.99693 13.6204 3.49442 13.3136 3.80126L9.11721 7.99762L13.3114 12.1918C13.6206 12.501 13.6206 13.0023 13.3114 13.3114C13.0023 13.6206 12.501 13.6206 12.1918 13.3114L7.99762 9.11721L3.885 13.2298C3.57816 13.5367 3.08067 13.5367 2.77383 13.2298C2.46699 12.923 2.46699 12.4255 2.77383 12.1187L6.88645 8.00604L2.69183 3.81142C2.38267 3.50226 2.38267 3.001 2.69183 2.69183C3.001 2.38267 3.50226 2.38267 3.81142 2.69183L8.00604 6.88646L12.2024 2.69009Z"\n                fill="currentColor"\n            ></path>\n        </svg>\n    </a>\n</div>\n<div id="namespace-add-error"></div>\n<a id="namespace-add-button">\n    <svg\n        focusable="false"\n        height="9px"\n        width="9px"\n        viewBox="0 0 1500 1500"\n        aria-hidden="false"\n        preserveAspectRatio="xMidYMid"\n        xmlns="http://www.w3.org/2000/svg"\n        style="fill: currentColor"\n    >\n        <path\n            d="M843.943 655.03L1500 656.058V844.97H843.943V1500H655.03V844.97L0 843.942V655.03h655.03V0h188.913"\n        ></path>\n    </svg>\n    Add Namespace\n</a>\n')({namespaces:s}));var n=r(this.defaultNamespaces,s).sort();u.render(h.createElement(p.SplunkThemeProvider,t({},x,{__self:this,__source:{fileName:L,lineNumber:40,columnNumber:7}}),h.createElement(M,{inline:!0,onBlur:function(t){e._addNewNamespace(t)},onKeyDown:function(t){e._handleKeyPress(t)},__self:this,__source:{fileName:L,lineNumber:41,columnNumber:9}},n.map((function(t){return h.createElement(M.Option,{key:t,value:t,__self:e,__source:{fileName:L,lineNumber:47,columnNumber:13}})})))),document.getElementById("namespace-value"));var l,c=a(i(".namespace-cell:not(#namespace-add-cell)"));try{for(c.s();!(l=c.n()).done;){var d=l.value;i(d).on("click",(function(t){e._selectNamespace(t)}))}}catch(e){c.e(e)}finally{c.f()}var m,f=a(i(".namespace-remove-button"));try{for(f.s();!(m=f.n()).done;){var v=m.value;i(v).on("click",(function(t){e._removeNamespace(t)}))}}catch(e){f.e(e)}finally{f.f()}i("#namespace-add-button").on("click",(function(t){e._onClickAddNamespace()})),i("#namespace-add-cancel-button").on("click",(function(t){e._onClickCancelNamespace()})),this._renderEditMarks(),this._addSelected()}},{key:"_onClickAddNamespace",value:function(){i("#namespace-add-cell").show(),i("#namespace-value>div>div").remove(),i("#namespace-value").trigger("focus")}},{key:"_onClickCancelNamespace",value:function(){i("#namespace-value").val("").removeClass("validate-error"),i("#namespace-add-cell").hide(),i("#namespace-add-error").hide()}},{key:"_selectNamespace",value:function(e){var t=i(e.target).data("namespace"),a=y(this.model,{metric_namespace:t});a&&(this.selectedModel=a),this._addSelected()}},{key:"_addSelected",value:function(){i(".namespace-cell").removeClass("selected");var e=this.selectedModel.metric_namespace;i('.namespace-cell[data-namespace="'.concat(e,'"]')).addClass("selected"),this._renderDimension()}},{key:"_addNewNamespace",value:function(e){var t=e.target.value.trim(),a=g(this.model,(function(e){return e.metric_namespace}));if(""===t)i("#namespace-add-error").text("Namespace value cannot be empty.").show(),i(e.currentTarget).addClass("validate-error");else if(-1===a.indexOf(t)){var s={};if(-1===this.defaultNamespaces.indexOf(t))s={metric_namespace:t,metric_dimensions_list:[],metric_names_list:[],statistics_list:[],change_set:[]};else{for(var n=[],c=[],r=l(this.defaultDimensions[t]),d=0;d<r.length;d++)n.push([".*"]),c.push(this.defaultStatistics);s={metric_namespace:t,metric_dimensions_list:r,metric_names_list:n,statistics_list:c,change_set:[]}}this.model.push(s),this.selectedModel=s,this._modifyEditMark(),this.editMarks.push(this.selectedModel.metric_namespace),this.render()}else i("#namespace-add-error").text("This namespace is already existed.").show(),i(e.target).addClass("validate-error")}},{key:"_removeNamespace",value:function(e){e.stopPropagation();var t=y(this.model,{metric_namespace:i(e.target).data("namespace")});if(t){var a=this.model.indexOf(t);a>-1&&this.model.splice(a,1)}this._modifyEditMark(),this.render();var s=this.model.length-1;s>-1&&(this.selectedModel=this.model[s],this._addSelected())}},{key:"_renderDimension",value:function(){new O({model:this.model,selectedModel:this.selectedModel,defaultDimensions:this.defaultDimensions,defaultMetrics:this.defaultMetrics,defaultStatistics:this.defaultStatistics}).render()}},{key:"_handleKeyPress",value:function(e){13===e.which&&i("#namespace-add-error").text("Press <TAB> key to add the selected namespace").show()}},{key:"_modifyEditMark",value:function(){this.editMarks=[];var e,t=a(i("div.namespace-edited-marker"));try{for(t.s();!(e=t.n()).done;){var s=e.value;this.editMarks.push(i(s).attr("data-namespace"))}}catch(e){t.e(e)}finally{t.f()}}},{key:"_renderEditMarks",value:function(){var e,t=a(this.editMarks);try{for(t.s();!(e=t.n()).done;){var s=e.value;i('.namespace-cell[data-namespace="'.concat(s,'"]')).addClass("namespace-edited-marker")}}catch(e){t.e(e)}finally{t.f()}}}]),n}(),E=function(){function t(e){s(this,t),this.model=e.model,this.defaultDimensions=e.defaultDimensions,this.defaultMetrics=e.defaultMetrics,this.defaultStatistics=e.defaultStatistics,this.defaultNamespaces=e.defaultNamespaces,this.selectedModel=this.model[0]}return e(t,[{key:"render",value:function(){var e=this;i('div[role="main"] > div > div[data-test="column-layout"] > div').hide();var t=o('<!DOCTYPE html>\n\x3c!--\n-- SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>\n-- SPDX-License-Identifier: LicenseRef-Splunk-8-2021\n--\n--\x3e\n\n<div\n    data-align-items="stretch"\n    data-test="row"\n    class="ucc-main-div advanced-metric-configuration"\n    style="padding: 5px 0px; margin-bottom: 4px"\n>\n    <div data-test="column" class="ucc-sub-div" style="flex: 1 1 auto; width: calc((100% - 88px) * 0.0833333 + 0px)">\n        <div class="page-subtitle">Inputs &gt; Cloudwatch Input &gt; Edit Metrics Configuration</div>\n    </div>\n</div>\n<div\n    data-align-items="stretch"\n    data-test="row"\n    class="ucc-main-div advanced-metric-configuration"\n    style="margin-top: 4px; margin-bottom: 4px; display: block"\n>\n    <div\n        data-test="column"\n        class="ucc-sub-div"\n        style="box-shadow: rgba(0, 0, 0, 0.2) 0px 4px 8px; padding: 1%; padding-bottom: 0%; flex: 8 8 auto; width: 100%; min-width: 1180px;"\n    >\n        <div id="advanced-submit-error-msg">\n            <svg\n                focusable="false"\n                height="24px"\n                width="24px"\n                viewBox="0 0 1375 1500"\n                aria-hidden="true"\n                preserveAspectRatio="xMidYMid"\n                xmlns="http://www.w3.org/2000/svg"\n                style="vertical-align: middle; fill: #dc4e41"\n            >\n                <path\n                    d="M187.5 61.5h1000c103.553 0 187.5 83.947 187.5 187.5v1000c0 103.553-83.947 187.5-187.5 187.5h-1000C83.947 1436.5 0 1352.553 0 1249V249C0 145.447 83.947 61.5 187.5 61.5zm400.79 413.083l32.145 257.167c4.908 39.264 34.086 74.685 69.815 91.187 36.612-16.018 64.87-50.826 69.914-91.187l32.146-257.167C799.18 419.623 759.582 374 703.7 374h-26.8c-55.908 0-95.555 45.033-88.61 100.583zm101.293 644.209c63.283 0 114.584-51.301 114.584-114.584 0-63.282-51.301-114.583-114.584-114.583-63.282 0-114.583 51.3-114.583 114.583s51.3 114.584 114.583 114.584z"\n                ></path>\n            </svg>\n            <div id="error-message" style="display: inline-block; padding: 0px 6px; vertical-align: middle"></div>\n        </div>\n        <table class="table table-chrome advanced-metrics-table">\n            <thead class="table-head">\n                <tr>\n                    <th>Namespace</th>\n                    <th class="no-border">Dimension</th>\n                    <th class="no-border">\n                        Dimension Value<span\n                            class="tooltip-icon"\n                            data-toggle="tooltip"\n                            data-container="body"\n                            title="CloudWatch metric dimensions as JSON array or object, with strings as keys and regular expressions as values. Splunk Web automatically populates correctly formatted JSON to collect all metric dimensions in the namespace you have selected"\n                            >?</span\n                        >\n                    </th>\n                    <th class="no-border">Metrics</th>\n                    <th class="no-border">Metric Statistics</th>\n                    <th class="no-border" style="padding: 5px; min-width: unset; background: inherit; width: 0.4%;"></th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr style="vertical-align: top">\n                    <td style="border-right: 1px solid #bfbfbf">\n                        <div class="list-section" id="namespace-list-section"></div>\n                    </td>\n                    <td colspan="5">\n                        <div class="list-section" id="dimension-list-section"></div>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n</div>\n<div\n    data-align-items="stretch"\n    data-test="row"\n    class="ucc-main-div metrics-configuration-footer advanced-metric-configuration"\n>\n    <button\n        data-test="button"\n        type="button"\n        label="Cancel"\n        id="metrics-cancel"\n        class="ucc-cancel-button ucc-base-button"\n        data-inline="true"\n    >\n        <span><span data-test="label">Cancel</span></span>\n    </button>\n    <button\n        data-test="button"\n        type="button"\n        label="Save Changes"\n        id="metrics-save"\n        class="ucc-save-button ucc-base-button"\n        data-inline="true"\n    >\n        <span><span data-test="label">Save Changes</span></span>\n    </button>\n</div>\n');i('div[role="main"] > div > div').append(t),this._renderNamespaces(),i("#metrics-cancel").on("click",(function(){return e._cancelModifications()}))}},{key:"_renderNamespaces",value:function(){this.namespaceListPanel=new J({model:this.model,selectedModel:this.selectedModel,defaultNamespaces:this.defaultNamespaces,defaultDimensions:this.defaultDimensions,defaultMetrics:this.defaultMetrics,defaultStatistics:this.defaultStatistics}),this.namespaceListPanel.render()}},{key:"_cancelModifications",value:function(){i(window).off("resize"),i(".advanced-metric-configuration").remove(),i('div[role="main"] > div > div[data-test="column-layout"] > div').css("display","flex")}},{key:"_validateModel",value:function(){if(i(".namespace-cell[data-namespace]").removeClass("validate-error"),!this.model.length)return"Metric configurations must have at least one namespace with appropriate metric, dimensions and statstics value. Please check.";var e,t=a(this.model);try{for(t.s();!(e=t.n()).done;){var s=e.value,n=s.metric_namespace;if(i(".json-err-state").length){var l=i(".json-err-state").attr("data-namespace");return i('.namespace-cell[data-namespace="'.concat(l,'"]')).addClass("validate-error"),"The metric dimension value of "+l+" should be a JSON array, of which elements should have same keys. Please check."}if(this._containsEmptyItem(s.metric_dimensions_list))return i('.namespace-cell[data-namespace="'.concat(n,'"]')).addClass("validate-error"),'The metric dimension value of "'+s.metric_namespace+'" is empty. Please check.';if(this._containsEmptyItem(s.metric_names_list))return i('.namespace-cell[data-namespace="'.concat(n,'"]')).addClass("validate-error"),'The metric name of "'+s.metric_namespace+'" is empty. Please check.';if(this._containsEmptyItem(s.statistics_list))return i('.namespace-cell[data-namespace="'.concat(n,'"]')).addClass("validate-error"),'The metric statistics of "'+s.metric_namespace+'" is empty. Please check.'}}catch(e){t.e(e)}finally{t.f()}}},{key:"_containsEmptyItem",value:function(e){return 0===e.length||k(e,(function(e){return b(e,[])||b(e,[""])}))}}]),t}(),P=function(){function t(e){s(this,t),this.model=e.model,this.defaultDimensions=e.defaultDimensions,this.defaultMetrics=e.defaultMetrics,this.el=i("#metrics-configuration-table > tbody")}return e(t,[{key:"render",value:function(){var e=this.model.metric_dimensions_list,t=this.model.metric_names_list,a=[],s=[],n=[];m(t,(function(e){s=_(s,e)})),m(e,(function(e){m(e,(function(e){a=_(a,c(e))}))})),m(this.defaultDimensions,(function(e){m(e,(function(e){n=_(n,c(e))}))}));var i=o('\x3c!--htmlhint spec-char-escape:false --\x3e\n<!DOCTYPE html>\n<tr>\n    <td><%-service%></td>\n    <td>\n        <% if (isDimensionModified) { %>\n        <a class="link-text configuration-modified-mark" href="javascript:;" title="<%-dimensions%>" data-service="<%-service%>"\n            >Modified</a\n        >\n        <% } else { %>\n        <span><%-dimensions%></span>\n        <% } %>\n    </td>\n    <td>\n        <% if (isMetricsModified) { %>\n        <a class="link-text configuration-modified-mark" href="javascript:;" title="<%-metrics%>" data-service="<%-service%>"\n            >Modified</a\n        >\n        <% } else { %>\n        <span><%-metrics%></span>\n        <% } %>\n    </td>\n</tr>\n')({service:this.model.metric_namespace,metrics:this._restrictStringLength(-1!==s.indexOf(".*")||this.defaultMetrics&&0===r(this.defaultMetrics,s).length?"All":s.join(", ")),dimensions:this._restrictStringLength(n.length>0&&0===r(n,a).length?"All":a.join(", ")),isMetricsModified:this.model.change_set.includes("metric_names_list"),isDimensionModified:this.model.change_set.includes("metric_dimensions_list")});this.el.append(i)}},{key:"_restrictStringLength",value:function(e){return e.length>50?e.substring(0,48)+"...":e}}]),t}(),T=function(){function t(e,a,n,i,l){var c=this;s(this,t),this.globalConfig=e,this.el=a,this.data=n,this.util=l,this.setValue=i,this.mainModel={},this.cachedChangeSet={},this._loadDefaultSettings().done((function(){c._generateViewModel(),c.render(),c._updateModel()}))}return e(t,[{key:"render",value:function(){var e=this;return this.el.innerHTML=o('\x3c!--htmlhint spec-char-escape:false --\x3e\n<!DOCTYPE html>\n\x3c!--\n-- SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>\n-- SPDX-License-Identifier: LicenseRef-Splunk-8-2021\n--\n--\x3e\n\n<div class="metrics-configuration-header">\n    <a href="javascript:;" class="link-text" id="metrics-configuration-advanced-setting">(Edit in advanced mode)</a>\n</div>\n<table class="metrics-table-view" id="metrics-configuration-table">\n    <tr>\n        <th>Name Service (<span class="metrics-configuration-count"><%-count%></span>)</th>\n        <th>Dimensions</th>\n        <th>Metrics</th>\n    </tr>\n</table>\n')({count:this.mainModel.length}),this._renderRows(),this.el.querySelector("#metrics-configuration-advanced-setting").addEventListener("click",(function(t){e._goAdvancedSetting()})),this}},{key:"_loadSelectedNameSpace",value:function(e){var t=i(e.target).data("service");this._goAdvancedSetting(),i(".namespace-cell[data-namespace='".concat(t,"']")).trigger("click")}},{key:"_loadDefaultSettings",value:function(){var e=this,t=N.exports.Deferred(),a=S("splunk_ta_aws/splunk_ta_aws_cloudwatch_default_settings",{app:"Splunk_TA_aws",sharing:"app"});return fetch(a+"?output_mode=json").then((function(e){return e.json()})).then((function(a){var s=a.entry[0].content,n=s.dimensions,i=s.metrics,l=s.statistics,c=s.namespaces,r=JSON.parse(n);for(var d in r){var o=g(r[d],(function(e){return[e]}));r[d]=o}e.defaultDimensions=r,e.defaultMetrics=JSON.parse(i),e.defaultStatistics=JSON.parse(l),e.defaultNamespaces=JSON.parse(c),t.resolve()})),t}},{key:"_generateViewModel",value:function(){var e=this,t=this.data.value,a=[];if(null===t)a=g(this.defaultNamespaces,(function(t){for(var a=[],s=[],n=l(e.defaultDimensions[t]),i=0;i<n.length;i++)a.push([".*"]),s.push(e.defaultStatistics);return{metric_namespace:t,metric_dimensions_list:n,metric_names_list:a,statistics_list:s,change_set:e.cachedChangeSet[t]||[]}}));else{t=JSON.parse(t);var s="",i="",c="",r={};this.util.setState((function(e){var t=n({},e.data);return s=JSON.parse(t.metric_dimensions.value),i=JSON.parse(t.metric_names.value),c=JSON.parse(t.statistics.value),{data:t}}));for(var d=0;d<t.length;d++){var o=t[d],m=JSON.parse(i[d]);if(".*"===m&&(m=[".*"]),C(r[o]))a.push({metric_namespace:o,metric_dimensions_list:[JSON.parse(s[d])],metric_names_list:[m],statistics_list:[JSON.parse(c[d])],change_set:this.cachedChangeSet[o]||[]}),r[o]=a.length-1;else{var u=a[r[o]];u.metric_dimensions_list.push(JSON.parse(s[d])),u.metric_names_list.push(m),u.statistics_list.push(JSON.parse(c[d]))}}}a=w(a,(function(e){return e.metric_namespace})),this.mainModel=a}},{key:"_renderRows",value:function(){var e=this;m(this.mainModel,(function(t){new P({model:t,defaultDimensions:e.defaultDimensions[t.metric_namespace],defaultMetrics:e.defaultMetrics[t.metric_namespace]}).render()})),i(".configuration-modified-mark").on("click",(function(t){e._loadSelectedNameSpace(t)}))}},{key:"_updateModel",value:function(){var e=this,t=[],a=[],s=[],i=[];m(this.mainModel,(function(n){for(var l=n.metric_namespace,c=n.metric_dimensions_list,r=n.metric_names_list,d=n.statistics_list,o=0;o<c.length;o++)t.push(l),a.push(JSON.stringify(c[o])),b(r[o],[".*"])?s.push('".*"'):s.push(JSON.stringify(r[o])),i.push(JSON.stringify(d[o]));e.cachedChangeSet[l]=n.change_set})),this.util.setState((function(e){var l=n({},e.data);return l.metric_namespace.value=JSON.stringify(t),l.metric_dimensions.value=JSON.stringify(a),l.metric_names.value=JSON.stringify(s),l.statistics.value=JSON.stringify(i),{data:l}}))}},{key:"_goAdvancedSetting",value:function(){var e=this;this.tempModel=JSON.parse(JSON.stringify(this.mainModel)),this.advancedView=new E({model:this.tempModel,defaultDimensions:this.defaultDimensions,defaultMetrics:this.defaultMetrics,defaultStatistics:this.defaultStatistics,defaultNamespaces:c(this.defaultDimensions)}),this.advancedView.render(),i("#metrics-save").on("click",(function(){return e._updateModifications()}))}},{key:"_updateModifications",value:function(){var e=this.advancedView._validateModel();e?(i("#error-message").text(e),i("#advanced-submit-error-msg").show()):(i(window).off("resize"),i(".advanced-metric-configuration").remove(),i('div[role="main"] > div > div[data-test="column-layout"] > div').css("display","flex"),this.mainModel=JSON.parse(JSON.stringify(this.tempModel)),this.render(),this._updateModel())}}]),t}();export{T as default};
//# sourceMappingURL=MetricsConfigurationView.js.map
